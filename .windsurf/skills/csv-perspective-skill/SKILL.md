---
name: csv-perspective
description: "专业的CSV数据透视处理工具，支持加权平均计算、数据聚合和批量处理。用于地质勘探、钻井数据等专业领域的数据分析任务。"
---

# CSV数据透视处理技能

## 技能概述

这是一个专业的CSV数据透视处理工具，能够对CSV文件执行复杂的数据聚合、加权平均计算和批量处理操作。特别适用于地质勘探、钻井数据等专业领域的数据分析任务。

## 功能特性

- **数据透视**：对CSV数据执行透视操作，按照指定字段进行分组
- **加权平均计算**：支持基于权重列的加权平均值计算
- **批量处理**：可以处理单个文件或整个目录下的所有CSV文件
- **灵活配置**：通过配置文件自定义处理逻辑
- **数据清洗**：支持列重命名、删除和排序

## 使用场景

使用此技能当您需要：
1. 对地质勘探数据进行统计分析
2. 处理钻井数据并计算加权平均值
3. 批量处理多个CSV文件
4. 执行数据透视和聚合操作
5. 基于置信度或权重的数据分析

## 命令行选项

```bash
python perspective.py [选项] <文件路径或文件夹路径>

选项:
  -h, --help          显示帮助信息
  -v, --version       显示程序版本
  -c, --config        指定配置文件路径
```

## 配置文件

配置文件定义了数据处理的具体规则，包含以下部分：

- `selected_columns`: 需要处理的列
- `rename_columns`: 列重命名映射
- `pivot_settings`: 透视设置（分组列、聚合方法、权重列）
- `columns_to_remove`: 需要删除的列
- `final_columns`: 最终输出的列顺序

## 示例用法

1. 处理单个CSV文件：
   ```bash
   python perspective.py data.csv
   ```

2. 处理整个目录中的CSV文件：
   ```bash
   python perspective.py ./data_folder
   ```

3. 使用自定义配置文件处理：
   ```bash
   python perspective.py -c my_config.json data.csv
   ```

## 输出结果

处理完成后，会在原文件同目录下生成带有"_透视结果"后缀的CSV文件，使用UTF-8编码以支持中文字符。
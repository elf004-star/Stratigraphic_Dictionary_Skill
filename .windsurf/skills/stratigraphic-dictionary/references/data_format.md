# 地层分层数据格式说明

## 数据文件格式

### 必需的数据文件格式

地层深度统计CSV文件必须包含以下四列：

| 列名 | 描述 | 示例 | 要求 |
|------|------|------|------|
| 地层名称 | 地层的具体名称 | 沙溪庙组底部 | 文本，不能为空 |
| 所属层位 | 地层所属的大类层位 | 沙溪庙组 | 文本，用于分组 |
| 顶界所处位置（0~1） | 地层顶部相对位置 | 0.00 | 数值，0-1之间 |
| 底界所处位置（0~1） | 地层底部相对位置 | 0.25 | 数值，0-1之间 |

### 可选的地层分层参考文件

`地层分层.csv` 文件用于定义标准地层顺序：

| 列名 | 描述 | 示例 |
|------|------|------|
| 序号 | 地层序号 | 1 |
| 地层信息 | 地层名称 | 沙溪庙组 |

## 文件路径说明

启动服务器时，可以通过相对路径或绝对路径指定数据文件：

```bash
# 相对路径（基于当前工作目录）
python scripts/start_server.py -d "data/stratigraphic_depth_statistics.csv"

# 绝对路径
python scripts/start_server.py -d "/home/user/project/data/file.csv"

# Windows绝对路径
python scripts/start_server.py -d "C:\Users\name\data\file.csv"
```

## 数据要求

1. **位置范围**：顶界和底界位置值必须在0-1之间
2. **逻辑关系**：底界位置必须大于顶界位置
3. **连续性**：相邻地层的边界应该连续或重叠
4. **编码**：文件使用UTF-8编码保存
5. **文件格式**：CSV格式，使用逗号分隔

## 示例数据结构

### 地层数据文件示例

```csv
地层名称,所属层位,顶界所处位置（0~1）,底界所处位置（0~1）
沙溪庙组底部,沙溪庙组,0.00,0.05
沙溪庙组中部,沙溪庙组,0.05,0.15
沙溪庙组顶部,沙溪庙组,0.15,0.25
凉高山组底部,凉高山组,0.25,0.30
```

### 地层分层参考文件示例

```csv
序号,地层信息
1,沙溪庙组
2,凉高山组
3,东岳庙组
```

## 常见错误及解决

| 错误 | 原因 | 解决方案 |
|------|------|----------|
| 缺少必需列 | CSV文件缺少必要的列名 | 检查列名是否完全匹配要求 |
| 位置值超范围 | 顶界/底界值不在0-1之间 | 检查数值并进行归一化处理 |
| 编码问题 | 文件不是UTF-8编码 | 使用文本编辑器另存为UTF-8格式 |
| 文件未找到 | 路径错误或文件不存在 | 确认文件路径正确，使用绝对路径测试 |
| 底界小于顶界 | 数据逻辑错误 | 检查数据，确保底界值大于顶界值 |

## 数据准备最佳实践

1. **使用标准模板**：复制 `sample_data.csv` 作为起点
2. **验证数据范围**：确保所有位置值在有效范围内
3. **统一地层命名**：在同一项目中保持地层名称一致
4. **备份原始数据**：编辑前备份原始CSV文件
5. **分层组织数据**：按所属层位合理组织地层顺序
